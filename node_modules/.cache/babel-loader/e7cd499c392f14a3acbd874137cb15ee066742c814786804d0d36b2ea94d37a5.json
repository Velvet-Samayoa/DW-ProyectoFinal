{"ast":null,"code":"import { collection, getDocs, query, where } from 'firebase/firestore';\nimport { db } from './config';\nimport deleteDocument from './deleteDocument';\nimport deleteFile from './deleteFile';\nconst deleteUserFiles = (collectionName, currentUser) => {\n  return new Promise(async (resolve, reject) => {\n    const q = query(collection(db, collectionName), where('uid', '==', currentUser.uid));\n    try {\n      const snapshot = await getDocs(q);\n      const storePromises = [];\n      const storagePromises = [];\n      snapshot.forEach(document => {\n        storePromises.push(deleteDocument(collectionName, document.id));\n        storagePromises.push(deleteFile(`${collectionName}/${currentUser.uid}/${document.id}`));\n      });\n      await Promise.all(storePromises);\n      await Promise.all(storagePromises);\n      if (currentUser !== null && currentUser !== void 0 && currentUser.photoURL) {\n        var _currentUser$photoURL, _currentUser$photoURL2;\n        const photoName = currentUser === null || currentUser === void 0 ? void 0 : (_currentUser$photoURL = currentUser.photoURL) === null || _currentUser$photoURL === void 0 ? void 0 : (_currentUser$photoURL2 = _currentUser$photoURL.split(`${currentUser.uid}%2F`)[1]) === null || _currentUser$photoURL2 === void 0 ? void 0 : _currentUser$photoURL2.split('?')[0];\n        if (photoName) {\n          try {\n            await deleteFile(`profile/${currentUser.uid}/${photoName}`);\n          } catch (error) {\n            console.log(error);\n          }\n        }\n      }\n      resolve();\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\nexport default deleteUserFiles;","map":{"version":3,"names":["collection","getDocs","query","where","db","deleteDocument","deleteFile","deleteUserFiles","collectionName","currentUser","Promise","resolve","reject","q","uid","snapshot","storePromises","storagePromises","forEach","document","push","id","all","photoURL","photoName","split","error","console","log"],"sources":["F:/UNIVERSIDAD/8vo semestre/Desarrollo Web/Examen Final/Proyecto/react-firebase-images-gallery-complete-project/src/firebase/deleteUserFiles.js"],"sourcesContent":["import { collection, getDocs, query, where } from 'firebase/firestore';\nimport { db } from './config';\nimport deleteDocument from './deleteDocument';\nimport deleteFile from './deleteFile';\n\nconst deleteUserFiles = (collectionName, currentUser) => {\n  return new Promise(async (resolve, reject) => {\n    const q = query(\n      collection(db, collectionName),\n      where('uid', '==', currentUser.uid)\n    );\n    try {\n      const snapshot = await getDocs(q);\n      const storePromises = [];\n      const storagePromises = [];\n      snapshot.forEach((document) => {\n        storePromises.push(deleteDocument(collectionName, document.id));\n        storagePromises.push(\n          deleteFile(`${collectionName}/${currentUser.uid}/${document.id}`)\n        );\n      });\n      await Promise.all(storePromises);\n      await Promise.all(storagePromises);\n\n      if (currentUser?.photoURL) {\n        const photoName = currentUser?.photoURL\n          ?.split(`${currentUser.uid}%2F`)[1]\n          ?.split('?')[0];\n        if (photoName) {\n          try {\n            await deleteFile(`profile/${currentUser.uid}/${photoName}`);\n          } catch (error) {\n            console.log(error);\n          }\n        }\n      }\n\n      resolve();\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\n\nexport default deleteUserFiles;\n"],"mappings":"AAAA,SAASA,UAAU,EAAEC,OAAO,EAAEC,KAAK,EAAEC,KAAK,QAAQ,oBAAoB;AACtE,SAASC,EAAE,QAAQ,UAAU;AAC7B,OAAOC,cAAc,MAAM,kBAAkB;AAC7C,OAAOC,UAAU,MAAM,cAAc;AAErC,MAAMC,eAAe,GAAG,CAACC,cAAc,EAAEC,WAAW,KAAK;EACvD,OAAO,IAAIC,OAAO,CAAC,OAAOC,OAAO,EAAEC,MAAM,KAAK;IAC5C,MAAMC,CAAC,GAAGX,KAAK,CACbF,UAAU,CAACI,EAAE,EAAEI,cAAc,CAAC,EAC9BL,KAAK,CAAC,KAAK,EAAE,IAAI,EAAEM,WAAW,CAACK,GAAG,CAAC,CACpC;IACD,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMd,OAAO,CAACY,CAAC,CAAC;MACjC,MAAMG,aAAa,GAAG,EAAE;MACxB,MAAMC,eAAe,GAAG,EAAE;MAC1BF,QAAQ,CAACG,OAAO,CAAEC,QAAQ,IAAK;QAC7BH,aAAa,CAACI,IAAI,CAACf,cAAc,CAACG,cAAc,EAAEW,QAAQ,CAACE,EAAE,CAAC,CAAC;QAC/DJ,eAAe,CAACG,IAAI,CAClBd,UAAU,CAAE,GAAEE,cAAe,IAAGC,WAAW,CAACK,GAAI,IAAGK,QAAQ,CAACE,EAAG,EAAC,CAAC,CAClE;MACH,CAAC,CAAC;MACF,MAAMX,OAAO,CAACY,GAAG,CAACN,aAAa,CAAC;MAChC,MAAMN,OAAO,CAACY,GAAG,CAACL,eAAe,CAAC;MAElC,IAAIR,WAAW,aAAXA,WAAW,eAAXA,WAAW,CAAEc,QAAQ,EAAE;QAAA;QACzB,MAAMC,SAAS,GAAGf,WAAW,aAAXA,WAAW,gDAAXA,WAAW,CAAEc,QAAQ,oFAArB,sBACdE,KAAK,CAAE,GAAEhB,WAAW,CAACK,GAAI,KAAI,CAAC,CAAC,CAAC,CAAC,2DADnB,uBAEdW,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACjB,IAAID,SAAS,EAAE;UACb,IAAI;YACF,MAAMlB,UAAU,CAAE,WAAUG,WAAW,CAACK,GAAI,IAAGU,SAAU,EAAC,CAAC;UAC7D,CAAC,CAAC,OAAOE,KAAK,EAAE;YACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;UACpB;QACF;MACF;MAEAf,OAAO,EAAE;IACX,CAAC,CAAC,OAAOe,KAAK,EAAE;MACdd,MAAM,CAACc,KAAK,CAAC;IACf;EACF,CAAC,CAAC;AACJ,CAAC;AAED,eAAenB,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}